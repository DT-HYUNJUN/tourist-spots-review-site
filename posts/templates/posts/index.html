{% extends 'base.html' %} 
{% load static %} 
{% block style %}
<style>
  *{
    box-sizing: border-box;
  }

  {% comment %} .box{
    border: 1px solid black;
  } {% endcomment %}

  section {
    margin-bottom: 1rem;
  }

  a {
    text-decoration: none;
    color: inherit;
  }

  #container-posts{
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    grid-template-rows; 1fr;
    column-gap: 5px;
    row-gap: 10px;
    background-color: red;
  }

  @media all and (max-width:479px) {
    #container-posts {
      grid-template-columns: 1fr;
      grid-template-rows: repeat(4, 1fr);
      column-gap: 10px;
      row-gap: 10px;
      background-color : yellow;
    }
  }

  .card-user{
    display: flex;
    flex-wrap: nowrap;
  }

  .username{
    margin-left: 0.5em;
  }
  
  .card-title {
    display: -webkit-box;
    -webkit-line-clamp: 1;
    -webkit-box-orient: vertical;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  .card {
    height: auto;
    border: 1px solid black;
    box-shadow: 3px 3px 10px;
    margin: auto;
    margin-bottom: 30px;
    transition: all 0.5s;
    transition-delay: 0.4s;
  }




  .post-item img{
    height: 200px;
    object-fit: fill;
    position: relative;
  }

  .like-user{
    position: absolute;
    top : 0;
    right: 0;
    background: none;
    border: none;
  }

  .user-profile:not(.post.image){
    width: 1.5em;
    height: 1.5em;
  }

  .main-img {
    width: 100%;
    height: 10em;
    object-fit: fill;
  }

  .noimage-img{
    display: block;
    margin: auto;
    width: 80%;
    object-fit: fill;
  }

  .viewed-order{
    display: flex;
  }

  .viewed-order-buttons{
    margin-left: auto;
  }

  .hidden {
    display: none;
  }
</style>
<link rel="stylesheet" href="{% static 'style/posts/index.css' %}">
{% endblock style %} 

{% block content %}

<main>
  <a href="{% url 'posts:region' 'ì„œìš¸' %}" data-subject="ì„œìš¸">ì„œìš¸</a>
  <section class="box">
    <img src="{% static 'img/posts-main-img.jpg' %}" class="main-img" alt="triptopperë² ë„ˆì´ë¯¸ì§€" />
  </section>
  <section class='Box viewed-order'>
    {% comment %} <div class="viewed-order-buttons">
      <button type="button" class="btn btn-outline-dark" >ìµœì‹ ìˆœ</button>
      <button type="button" class="btn btn-outline-dark" >ì¸ê¸°ìˆœ</button>
      <button type="button" class="btn btn-outline-dark" >ëŒ“ê¸€ìˆœ</button>
    </div> {% endcomment %}
    <form method="GET">
      <div class="d-flex justify-content-end align-items-center gap-1 mb-2">
        <select name="select_sorting" id="select_sorting" class="p-1 rounded-1">
          <option value="ìµœì‹ ìˆœ" {% if select_sorting == 'ìµœì‹ ìˆœ' %}selected{% endif %}>ìµœì‹ ìˆœ</option>
          <option value="ì˜¤ë˜ëœìˆœ" {% if select_sorting == 'ì˜¤ë˜ëœìˆœ' %}selected{% endif %}>ì˜¤ë˜ëœìˆœ</option>
        </select>
        <input type="submit" class="btn btn-secondary btn-sm" value="ì •ë ¬">
      </div>
    </form>

    <div class="d-flex">
      <button id="region-button" class="btn btn-secondary region-button">ì§€ì—­ <span>></span></button>
      <ul id="region-list" class="region-list">
        <li class="btn btn-light"><a href="{% url 'posts:index' %}">ì „ì²´</a></li>
        <li class="btn btn-light"><a href="{% url 'posts:region' 'ì„œìš¸' %}">ì„œìš¸</a></li>
        <li class="btn btn-light">ê²½ê¸°</li>
        <li class="btn btn-light">ì¶©ë‚¨</li>
      </ul>
    </div>

  </section>
  <section class="box">
    <div id="container-posts">
      {% for post in posts %}
      <div class="post-item">
        <a href="{% url 'posts:detail' post.pk %}" class="card">
          {% if post.image %}
          <img src="{{ post.image.url }}" alt="ì—¬í–‰ì‚¬ì§„" class="card-img-top" />
          {% else %}
          <img
            src="{% static 'img/noimage.jpg' %}"
            alt="ì´ë¯¸ì§€ì—†ìŒ"
            class="card-img-top noimage-img"
          />
          {% endif %}
          <form action="{% url 'posts:post_likes' post.pk %}" method="POST">
            {% csrf_token %}
            {% if request.user in post.like_posts.all %}
            <input class='like-user' type="submit" value="ğŸ¤">
            {% else %}
            <input class='like-user' type="submit" value="â¤">
            {% endif %}
          </form>


          <div class="card-body">
            <div class="card-user">
              <p>
                {% if post.user.profile_image %}
                <img
                  class="user-profile"
                  src="{{ post.user.profile_image }}"
                  alt="ì‚¬ìš©ìí”„ë¡œí•„ì´ë¯¸ì§€"
                />
                {% else %}
                <img
                class="user-profile"
                src="{% static 'img/user_profile.png' %}"
                alt="ê¸°ë³¸í”„ë¡œí•„ì´ë¯¸ì§€"
                />
              </p>
                {% endif %}
              <span class="username">{{user}}</span>
            </div>
            <h6 class="card-title">{{ post.title }}</h6>
          </div>
        </a>
      </div>
      {% endfor %}
    </div>
  </section>

  <ul class="pagination justify-content-center mt-5"> 
    {% comment %}
        ì´ì „ í˜ì´ì§€ ë²„íŠ¼
        ì´ì „ í˜ì´ì§€ê°€ ì¡´ì¬í•  ê²½ìš° ì´ì „ í˜ì´ì§€ ë²„íŠ¼ í™œì„±í™”
    {% endcomment %}
    {% if posts.has_previous %}
      <li class="page-item">
        <a class="page-link" href="?page=1">ì²˜ìŒìœ¼ë¡œ</a>
      </li>
      <li class="page-item">
        <a class="page-link" href="?page={{ posts.previous_page_number }}">ì´ì „</a>
      </li>
    {% else %}
      <li class="page-item disabled">
        <a class="page-link" tabindex="-1" aria-disabled="true" href="#">ì´ì „</a>
      </li>
    {% endif %}
    {% comment %}
        í˜ì´ì§€ ë²ˆí˜¸ ë¦¬ìŠ¤íŠ¸ ìƒì„± ë°˜ë³¸ë¶
    {% endcomment %}
    {% for page_number in posts.paginator.page_range %}
      {% comment %}
        í˜ì´ì§€ ë²ˆí˜¸ê°€ ë¬´í•œíˆ ìƒì„±ë˜ëŠ” ê²ƒì„ ë§‰ëŠ” ì¡°ê±´ë¬¸
        í˜„ì¬ í˜ì´ì§€ì—ì„œ +- 5 ê¹Œì§€ ìƒì„±
      {% endcomment %}
      {% if page_number >= posts.number|add:-5 and page_number <= posts.number|add:5 %}
        {% if page_number == posts.number %}
          <li class="page-item active" aria-current="page">
            <a class="page-link" href="?page={{ page_number }}">{{ page_number }}</a>
          </li>
        {% else %}
          <li class="page-item">
            <a class="page-link" href="?page={{ page_number }}">{{ page_number }}</a>
          </li>
        {% endif %}
      {% endif %}
    {% endfor %}
    {% comment %}
        ë‹¤ìŒ í˜ì´ì§€ ë²„íŠ¼
        ë‹¤ìŒ í˜ì´ì§€ê°€ ì¡´ì¬í•  ê²½ìš° ë‹¤ìŒ í˜ì´ì§€ ë²„íŠ¼ í™œì„±í™”
    {% endcomment %}
    {% if posts.has_next %}
      <li class="page-item">
        <a class="page-link" href="?page={{ posts.next_page_number }}">ë‹¤ìŒ</a>
      </li>
      <li class="page-item">
        <a class="page-link" href="?page={{ last_page }}">ë§ˆì§€ë§‰ìœ¼ë¡œ</a>
      </li>
    {% else %}
      <li class="page-item disabled">
        <a class="page-link" tabindex="-1" aria-disabled="true" href="#">ë‹¤ìŒ</a>
      </li>
    {% endif %}
  </ul>
</main>

{% endblock content %}

{% block javascript %}
<script src="{% static 'js/region.js' %}"></script>
{% endblock javascript %}