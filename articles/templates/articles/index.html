{% extends "base.html" %}
{% load static %}
{% block style %}
<style>
h2 {
  margin: 0;
}
.main--form--wrap {
  display: flex;
  justify-content: center;
}
.main--article--container {
  {% comment %} padding: 70px 0; {% endcomment %}
}
.article--table {
  text-align:center;
}
.article--title--wrap{
  display: flex;
  justify-content: space-between;
  align-items: flex-end;
}


.profile--image {
  border: 1px solid gray;
  border-radius: 5px;
  width: 25px;
}

.main--article--container{
  max-width: ;
  margin: auto;
}
.card--style--wrap {
  border: 1px solid #cccccc;
  border-radius: 10px;
  box-shadow: 2px 2px 5px 2px rgba(204,204,204, .5);
  padding: 1rem;
  margin-bottom: 1rem;
}
.article--title--wrap {
  display: flex;
  justify-content: space-between;
  align-items: flex-end;
  margin: 0 20px;
}
.article--title {
  border: 1px solid rgb(128, 128, 128);
  border-radius: 10px 10px 0 0;
  background-color: #28a745;
  padding: 0.1rem 1rem;
  margin: 0;
}
.article--list {
  border: 1px solid rgb(128, 128, 128);
  border-radius: 10px 10px 0 0;
  background-color: #ffc107;
  padding: 0.1rem 1rem;
}
</style>
{% endblock style %}
{% block content %}
<article class="main--article--container">
  <div class="article--title--wrap">
    <h3 class="article--title">Community</h3>
    <a class="article--list" href="{% url 'articles:index' %}">list</a>
  </div>
  <div class="card--style--wrap">
    <div class='d-flex justify-content-between my-1'>
      <form  method='GET' class='main--form--wrap'>
        <select name='order' class="form-select me-2">
          <option value="1">최신글</option>
          <option value="2">인기글</option>
          <option value="3">많이본 글</option>
        </select>
        <input type="submit" value='정렬' class="btn btn-secondary btn-sm">
      </form>
      <a type="button" class="btn btn-success" href="{% url 'articles:create' %}">글 생성</a>
    </div>
  
  
    <table class="article--table table table-hover">
      <thead>
        <tr>
          <th scope="col">No</th>
          <th scope="col">제목</th>
          <th scope="col">글쓴이</th>
          <th scope="col">작성시간</th>
          <th scope="col">조회수</th>
        </tr>
      </thead>
      <tbody class="table-group-divider">
        {% for article in articles %}
        <tr>
          <th scope="row">{{ article.pk }}</th>
          <td>
            <a href="{% url 'articles:detail' article.pk %}">
              {{ article.title }}({{ article.articlecomment_set.all|length }})
            </a>
          </td>
          <td><span class="profile--image--wrap">
            {% if article.user.profile_image %}
            <img class="profile--image" src="{{ article.user.profile_image.url }}" alt="profile-image">
            {% else %}
            <img class="profile--image" src="{% static 'img/cat_01.png' %}" alt="profile">
            {% endif %}    
          </span>{{ article.user }}</td>
          <td>{{ article.created_at }}</td>
          <td>{{ article.views.all|length }}</td>
        </tr>
    
      {% comment %} <form id="myForm" action="{% url 'articles:detail' article.pk %}" method='POST'>
        {% csrf_token %}
        <a href="{% url 'articles:detail' article.pk %}" id="submitForm">{{ article.title }}</a> 
      </form> {% endcomment %}
    {% endfor %}
    </tbody>
    </table>

    <a href="{% url 'articles:tag_cloud' %}"><span class="btn btn-secondary btn-sm mb-3">TagCloud</span></a> 
  </div>
</article>



{% endblock content %}

{% block javascript %}
  <script>
    const submitFormBtn = document.getElementById("submitForm");
    const myForm = document.getElementById("myForm");
    
    submitFormBtn.addEventListener("click", (event) => {
      event.preventDefault(); // 이벤트 전파 중지
      myForm.submit(); // 폼 제출
    });
  </script>
{% endblock javascript %}