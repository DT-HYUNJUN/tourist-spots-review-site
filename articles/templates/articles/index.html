{% extends "base.html" %}
{% block style %}
<style>
h2 {
  margin: 0;
}
.main--form--wrap {
  display: flex;
  justify-content: center;
}
.main--article--container {
  {% comment %} padding: 70px 0; {% endcomment %}
}
.article--table {
  text-align:center;
}
.article--title--wrap{
  display: flex;
  justify-content: space-between;
  align-items: flex-end;
}
</style>
{% endblock style %}
{% block content %}
<article class="main--article--container">
  <div>
      <h2>Community</h2>
    <div class='d-flex justify-content-between my-1'>
      <form  method='GET' class='main--form--wrap'>
        <select name='order' class="form-select me-2">
          <option value="1">최신글</option>
          <option value="2">인기글</option>
          <option value="3">많이본 글</option>
        </select>
        <input type="submit" value='정렬' class="btn btn-secondary btn-sm">
      </form>
      <a href="{% url 'articles:create' %}">글 생성</a>
    </div>
  </div>
  
  <table class="article--table table">
    <thead>
      <tr>
        <th scope="col">No</th>
        <th scope="col">제목</th>
        <th scope="col">글쓴이</th>
        <th scope="col">작성시간</th>
        <th scope="col">조회수</th>
      </tr>
    </thead>
    <tbody class="table-group-divider">
  {% for article in articles %}
      <tr>
        <th scope="row">{{ article.pk }}</th>
        <td><a href="{% url 'articles:detail' article.pk %}">{{ article.title }}</a></td>
        <td>{{ article.user }}</td>
        <td>{{ article.created_at }}</td>
        <td>{{ article.views.all|length }}</td>
      </tr>
  
    {% comment %} <form id="myForm" action="{% url 'articles:detail' article.pk %}" method='POST'>
      {% csrf_token %}
      <a href="{% url 'articles:detail' article.pk %}" id="submitForm">{{ article.title }}</a> 
    </form> {% endcomment %}
  {% endfor %}
  </tbody>
  </table>

  <a href="{% url 'articles:tag_cloud' %}"><span class="btn btn-secondary btn-sm mb-3">TagCloud</span></a> 
</article>



{% endblock content %}

{% block javascript %}
  <script>
    const submitFormBtn = document.getElementById("submitForm");
    const myForm = document.getElementById("myForm");
    
    submitFormBtn.addEventListener("click", (event) => {
      event.preventDefault(); // 이벤트 전파 중지
      myForm.submit(); // 폼 제출
    });
  </script>
{% endblock javascript %}