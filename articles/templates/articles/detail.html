{% extends 'base.html' %}

{% block content %}
<p>articles detail</p>
<form action="{% url 'articles:delete' article.pk %}" method="POST">
  {% csrf_token %}
  <input type="submit" value="[삭제]">
</form>
<a href="{% url 'articles:update' article.pk %}">[수정]</a>
<p>{{ article.title }}</p>
{% if article.image %}
  <img src="{{ article.image.url }}" alt="{{ article.image }}">
{% else %}
  <p>No Image</p>
{% endif %}

<form action="{% url 'articles:likes' article.pk %}" method='POST'>
  {% csrf_token %}
  {% if request.user in article.like_users.all %}
    <input type="submit" value='unlike'>
    {% else %}
    <input type="submit" value='like'>
    {% endif %}
    {{ article.like_users.all|length }}
</form>

<form action="{% url 'articles:comment_create' article.pk %}" method='POST'>
  {% csrf_token %}
  {{ comment_form.content }}
  <input type="submit" value='작성'>
</form>
{% for comment in comments %}
  {{comment.user}} - {{comment.content}}
  <form action="{% url 'articles:comment_likes' article.pk comment.pk %}" mehtod='POST'>
    {% csrf_token %}
    {% if request.user in comment.like_users.all %}
    <p></p>
      <input type="submit" value='unlike'>
      {% else %}
      <input type="submit" value='like'>
      {% endif %}
      {{ comment.like_users.all|length }}
  </form>
  <form action="{% url 'articles:comment_delete' article.pk comment.pk %}" method='POST'>
    {% csrf_token %}
    <input type="submit" value='삭제'>
  </form>
{% endfor %}


{% endblock content %}